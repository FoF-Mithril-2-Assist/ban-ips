{"version":3,"sources":["webpack://@fof/ban-ips/webpack/bootstrap","webpack://@fof/ban-ips/external \"flarum.core.compat['Model']\"","webpack://@fof/ban-ips/./node_modules/@babel/runtime/helpers/esm/inheritsLoose.js","webpack://@fof/ban-ips/external \"flarum.core.compat['extend']\"","webpack://@fof/ban-ips/external \"flarum.core.compat['components/Button']\"","webpack://@fof/ban-ips/external \"flarum.core.compat['helpers/username']\"","webpack://@fof/ban-ips/external \"flarum.core.compat['components/Alert']\"","webpack://@fof/ban-ips/external \"flarum.core.compat['models/Forum']\"","webpack://@fof/ban-ips/external \"flarum.core.compat['components/Modal']\"","webpack://@fof/ban-ips/external \"flarum.core.compat['helpers/punctuateSeries']\"","webpack://@fof/ban-ips/./src/common/models/BannedIP.js","webpack://@fof/ban-ips/external \"flarum.core.compat['utils/mixin']\"","webpack://@fof/ban-ips/external \"flarum.core.compat['utils/PostControls']\"","webpack://@fof/ban-ips/external \"flarum.core.compat['models/User']\"","webpack://@fof/ban-ips/external \"flarum.core.compat['components/Badge']\"","webpack://@fof/ban-ips/./src/forum/components/BanIPModal.js","webpack://@fof/ban-ips/./src/forum/index.js","webpack://@fof/ban-ips/./src/forum/addBanIPControl.js","webpack://@fof/ban-ips/./src/forum/addBannedBadge.js"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","flarum","core","compat","_inheritsLoose","subClass","superClass","constructor","__proto__","__webpack_exports__","BannedIP","apiEndpoint","this","exists","id","mixin","Model","creator","hasOne","user","address","attribute","reason","createdAt","transformDate","deletedAt","BanIPModal","init","post","props","banOptions","banOption","prop","otherUsersBanned","loading","className","title","app","translator","trans","content","_this","usernames","map","u","displayName","type","checked","onclick","htmlFor","ip","ipAddress","bidi","length","Alert","component","children","users","punctuateSeries","dismissible","Button_default","a","onsubmit","e","preventDefault","getOtherUsers","attrs","userId","store","createRecord","save","then","hide","onerror","loaded","markBanned","request","data","attributes","url","forum","method","errorHandler","_this2","res","pushObject","lazyRedraw","pushAttributes","isBanned","console","log","Modal","initializers","add","models","posts","canBanIP","banned_ips","Forum","bannedIPs","hasMany","extend","PostControls","items","isHidden","session","contentType","Button","icon","disabled","modal","show","User","Badge","label"],"mappings":"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","file":"forum.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 19);\n","module.exports = flarum.core.compat['Model'];","export default function _inheritsLoose(subClass, superClass) {\n  subClass.prototype = Object.create(superClass.prototype);\n  subClass.prototype.constructor = subClass;\n  subClass.__proto__ = superClass;\n}","module.exports = flarum.core.compat['extend'];","module.exports = flarum.core.compat['components/Button'];","module.exports = flarum.core.compat['helpers/username'];","module.exports = flarum.core.compat['components/Alert'];","module.exports = flarum.core.compat['models/Forum'];","module.exports = flarum.core.compat['components/Modal'];","module.exports = flarum.core.compat['helpers/punctuateSeries'];","import Model from 'flarum/Model';\nimport mixin from 'flarum/utils/mixin';\n\nexport default class BannedIP extends mixin(Model, {\n    creator: Model.hasOne('creator'),\n    user: Model.hasOne('user'),\n    address: Model.attribute('address'),\n    reason: Model.attribute('reason'),\n    createdAt: Model.attribute('createdAt', Model.transformDate),\n    deletedAt: Model.attribute('deletedAt', Model.transformDate),\n}) {\n    apiEndpoint() {\n        return `/fof/ban-ips${this.exists ? `/${this.id()}` : ''}`;\n    }\n}\n","module.exports = flarum.core.compat['utils/mixin'];","module.exports = flarum.core.compat['utils/PostControls'];","module.exports = flarum.core.compat['models/User'];","module.exports = flarum.core.compat['components/Badge'];","import Modal from 'flarum/components/Modal';\nimport Button from 'flarum/components/Button';\nimport Alert from 'flarum/components/Alert';\nimport punctuateSeries from 'flarum/helpers/punctuateSeries';\nimport username from 'flarum/helpers/username';\n\nexport default class BanIPModal extends Modal {\n    init() {\n        this.post = this.props.post;\n        this.user = this.post.user();\n\n        this.banOptions = ['only', 'all'];\n        this.banOption = m.prop(this.banOptions[0]);\n        this.reason = m.prop('');\n\n        this.otherUsersBanned = {};\n\n        this.loading = false;\n    }\n\n    className() {\n        return 'Modal--medium';\n    }\n\n    title() {\n        return app.translator.trans('fof-ban-ips.lib.modal.title');\n    }\n\n    content() {\n        const otherUsersBanned = this.otherUsersBanned[this.banOption()];\n        const usernames =\n            otherUsersBanned && otherUsersBanned.map(u => (u && u.displayName()) || app.translator.trans('core.lib.username.deleted_text'));\n\n        return (\n            <div className=\"Modal-body\">\n                <p>{app.translator.trans('fof-ban-ips.lib.modal.ban_ip_confirmation')}</p>\n\n                <div className=\"Form-group\">\n                    {this.banOptions.map(key => (\n                        <div>\n                            <input\n                                type=\"radio\"\n                                name=\"ban-option\"\n                                id={`ban-option-${key}`}\n                                checked={this.banOption() === key}\n                                onclick={this.banOption.bind(this, key)}\n                            />\n                            &nbsp;\n                            <label htmlFor={`ban-option-${key}`}>\n                                {app.translator.trans(`fof-ban-ips.forum.modal.ban_options_${key}_ip`, {\n                                    user: this.user,\n                                    ip: this.post.ipAddress(),\n                                })}\n                            </label>\n                        </div>\n                    ))}\n                </div>\n\n                <div className=\"Form-group\">\n                    <label className=\"label\">Reason</label>\n                    <input type=\"text\" className=\"FormControl\" bidi={this.reason} />\n                </div>\n\n                {otherUsersBanned\n                    ? otherUsersBanned.length\n                        ? Alert.component({\n                              children: app.translator.trans('fof-ban-ips.lib.modal.ban_ip_users', { users: punctuateSeries(usernames) }),\n                              dismissible: false,\n                          })\n                        : Alert.component({\n                              children: app.translator.trans('fof-ban-ips.forum.modal.ban_ip_no_users'),\n                              dismissible: false,\n                              type: 'success',\n                          })\n                    : ''}\n\n                {otherUsersBanned && <br />}\n\n                <div className=\"Form-group\">\n                    <Button className=\"Button Button--primary\" type=\"submit\" loading={this.loading}>\n                        {usernames\n                            ? app.translator.trans('fof-ban-ips.lib.modal.submit_button')\n                            : app.translator.trans('fof-ban-ips.lib.modal.check_button')}\n                    </Button>\n                </div>\n            </div>\n        );\n    }\n\n    onsubmit(e) {\n        e.preventDefault();\n\n        this.loading = true;\n\n        if (typeof this.otherUsersBanned[this.banOption()] === 'undefined') return this.getOtherUsers();\n\n        const attrs = {\n            reason: this.reason(),\n            userId: this.user.id(),\n        };\n\n        if (this.banOption() === 'only') {\n            attrs.address = this.post.ipAddress();\n\n            app.store\n                .createRecord('banned_ips')\n                .save(attrs)\n                .then(this.hide.bind(this), this.onerror.bind(this), this.loaded.bind(this), this.markBanned.bind(this));\n        } else if (this.banOption() === 'all') {\n            app.request({\n                data: {\n                    data: {\n                        attributes: attrs,\n                    },\n                },\n                url: `${app.forum.attribute('apiUrl')}${this.user.apiEndpoint()}/ban`,\n                method: 'POST',\n                errorHandler: this.onerror.bind(this),\n            })\n                .then(this.markBanned.bind(this), this.hide.bind(this))\n                .catch(() => {})\n                .then(this.loaded.bind(this))\n        }\n    }\n\n    getOtherUsers() {\n        const data = {};\n\n        if (this.banOption() === 'only') data.ip = this.post.ipAddress();\n\n        app.request({\n            data,\n            url: `${app.forum.attribute('apiUrl')}/fof/ban-ips/check-users/${this.user.id()}`,\n            method: 'GET',\n            errorHandler: this.onerror.bind(this),\n        })\n            .then(res => {\n                this.otherUsersBanned[this.banOption()] = res.data.map(e => app.store.pushObject(e));\n                this.loading = false;\n\n                m.lazyRedraw();\n            })\n            .catch(() => {})\n            .then(this.loaded.bind(this));\n    }\n\n    markBanned() {\n        this.user.pushAttributes({\n            isBanned: true\n        });\n\n        console.log(this.user.isBanned());\n    }\n}\n","import Model from 'flarum/Model';\nimport Forum from 'flarum/models/Forum';\n\nimport addBanIPControl from './addBanIPControl';\nimport BannedIP from '../common/models/BannedIP';\nimport addBannedBadge from './addBannedBadge';\n\napp.initializers.add('fof/ban-ips', () => {\n    app.store.models.posts.prototype.canBanIP = Model.attribute('canBanIP');\n    app.store.models.posts.prototype.ipAddress = Model.attribute('ipAddress');\n    app.store.models.users.prototype.isBanned = Model.attribute('isBanned');\n\n    app.store.models.banned_ips = BannedIP;\n\n    Forum.prototype.bannedIPs = Model.hasMany('banned_ips');\n\n    addBanIPControl();\n    addBannedBadge();\n});\n","import { extend } from 'flarum/extend';\nimport PostControls from 'flarum/utils/PostControls';\nimport Button from 'flarum/components/Button';\nimport BanIPModal from './components/BanIPModal';\n\nexport default () => {\n    extend(PostControls, 'userControls', function(items, post) {\n        const isBanned = post.user().isBanned();\n\n        // Removes ability to ban thyself and also does permission check.\n        if (!post.canBanIP() || post.isHidden() || post.user() === app.session.user || post.contentType() !== 'comment') return;\n\n        items.add(\n            'banip',\n            Button.component({\n                children: app.translator.trans(!isBanned ? 'fof-ban-ips.forum.ban_ip_button' : 'fof-ban-ips.forum.already_banned_ip_button'),\n                className: 'Button Button--link',\n                icon: 'fas fa-gavel',\n                disabled: isBanned,\n                onclick: () => app.modal.show(new BanIPModal({ post })),\n            })\n        );\n    });\n};\n","import { extend } from 'flarum/extend';\nimport User from 'flarum/models/User';\nimport Badge from 'flarum/components/Badge';\n\nexport default () => {\n    extend(User.prototype, 'badges', function(items) {\n        if (this.isBanned()) {\n            items.add(\n                'banned',\n                Badge.component({\n                    icon: 'fas fa-gavel',\n                    type: 'banned',\n                    label: app.translator.trans('fof-ban-ips.forum.user_badge.banned_tooltip'),\n                })\n            );\n        }\n    });\n};\n"],"sourceRoot":""}