{"version":3,"sources":["webpack://@fof/ban-ips/webpack/bootstrap","webpack://@fof/ban-ips/./forum.js","webpack://@fof/ban-ips/./node_modules/@babel/runtime/helpers/esm/inheritsLoose.js","webpack://@fof/ban-ips/./src/common/models/BannedIP.js","webpack://@fof/ban-ips/./src/forum/addBanIPControl.js","webpack://@fof/ban-ips/./src/forum/components/BanIPModal.js","webpack://@fof/ban-ips/./src/forum/index.js","webpack://@fof/ban-ips/external \"flarum.core.compat['Model']\"","webpack://@fof/ban-ips/external \"flarum.core.compat['components/Alert']\"","webpack://@fof/ban-ips/external \"flarum.core.compat['components/Button']\"","webpack://@fof/ban-ips/external \"flarum.core.compat['components/Modal']\"","webpack://@fof/ban-ips/external \"flarum.core.compat['extend']\"","webpack://@fof/ban-ips/external \"flarum.core.compat['helpers/punctuateSeries']\"","webpack://@fof/ban-ips/external \"flarum.core.compat['helpers/username']\"","webpack://@fof/ban-ips/external \"flarum.core.compat['models/Forum']\"","webpack://@fof/ban-ips/external \"flarum.core.compat['utils/PostControls']\"","webpack://@fof/ban-ips/external \"flarum.core.compat['utils/mixin']\""],"names":["BannedIP","apiEndpoint","exists","id","mixin","Model","creator","hasOne","user","address","attribute","reason","createdAt","transformDate","deletedAt","extend","PostControls","items","post","postIP","ipAddress","isBanned","canBanIP","isHidden","app","session","contentType","add","Button","component","children","translator","trans","className","icon","disabled","onclick","modal","show","BanIPModal","init","props","banOptions","banOption","m","prop","otherUsersBanned","loading","title","content","usernames","map","u","displayName","key","bind","ip","length","Alert","users","punctuateSeries","dismissible","type","onsubmit","e","preventDefault","getOtherUsers","attrs","userId","store","createRecord","save","then","hide","onerror","loaded","request","data","attributes","url","forum","method","errorHandler","res","pushObject","lazyRedraw","Modal","initializers","models","posts","prototype","banned_ips","Forum","bannedIPs","hasMany","addBanIPControl"],"mappings":"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","file":"forum.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./forum.js\");\n","export * from './src/forum';\n","export default function _inheritsLoose(subClass, superClass) {\n  subClass.prototype = Object.create(superClass.prototype);\n  subClass.prototype.constructor = subClass;\n  subClass.__proto__ = superClass;\n}","import Model from 'flarum/Model';\nimport mixin from 'flarum/utils/mixin';\n\nexport default class BannedIP extends mixin(Model, {\n    creator: Model.hasOne('user'),\n    user: Model.hasOne('user'),\n    address: Model.attribute('address'),\n    reason: Model.attribute('reason'),\n    createdAt: Model.attribute('createdAt', Model.transformDate),\n    deletedAt: Model.attribute('deletedAt', Model.transformDate),\n}) {\n    apiEndpoint() {\n        return `/fof/ban-ips/bans${this.exists ? `/${this.id()}` : ''}`;\n    }\n}\n","import { extend } from 'flarum/extend';\nimport PostControls from 'flarum/utils/PostControls';\nimport Button from 'flarum/components/Button';\nimport BanIPModal from './components/BanIPModal';\n\nexport default () => {\n    extend(PostControls, 'userControls', function(items, post) {\n        const postIP = post.ipAddress();\n        const isBanned = post.user().isBanned();\n\n        // Removes ability to ban thyself and also does permission check.\n        if (!post.canBanIP() || post.isHidden() || post.user() === app.session.user || post.contentType() !== 'comment') return;\n\n        items.add(\n            'banip',\n            Button.component({\n                children: app.translator.trans(!isBanned ? 'fof-ban-ips.forum.ban_ip_button' : 'fof-ban-ips.forum.already_banned_ip_button'),\n                className: 'Button Button--link',\n                icon: 'fas fa-ban',\n                disabled: isBanned,\n                onclick: () => app.modal.show(new BanIPModal({ post })),\n            })\n        );\n    });\n};\n","import Modal from 'flarum/components/Modal';\nimport Button from 'flarum/components/Button';\nimport Alert from 'flarum/components/Alert';\nimport punctuateSeries from 'flarum/helpers/punctuateSeries';\nimport username from 'flarum/helpers/username';\n\nexport default class BanIPModal extends Modal {\n    init() {\n        this.post = this.props.post;\n        this.user = this.post.user();\n\n        this.banOptions = ['only', 'all'];\n        this.banOption = m.prop(this.banOptions[0]);\n        this.reason = m.prop('');\n\n        this.otherUsersBanned = {};\n\n        this.loading = false;\n    }\n\n    className() {\n        return 'Modal--medium';\n    }\n\n    title() {\n        return app.translator.trans('fof-ban-ips.lib.modal.title');\n    }\n\n    content() {\n        const otherUsersBanned = this.otherUsersBanned[this.banOption()];\n        const usernames =\n            otherUsersBanned && otherUsersBanned.map(u => (u && u.displayName()) || app.translator.trans('core.lib.username.deleted_text'));\n\n        return (\n            <div className=\"Modal-body\">\n                <p>{app.translator.trans('fof-ban-ips.forum.ban_ip_confirmation')}</p>\n\n                <div className=\"Form-group\">\n                    {this.banOptions.map(key => (\n                        <div>\n                            <input\n                                type=\"radio\"\n                                name=\"ban-option\"\n                                id={`ban-option-${key}`}\n                                checked={this.banOption() === key}\n                                onclick={this.banOption.bind(this, key)}\n                            />\n                            &nbsp;\n                            <label htmlFor={`ban-option-${key}`}>\n                                {app.translator.trans(`fof-ban-ips.forum.modal.ban_options_${key}_ip`, {\n                                    user: this.user,\n                                    ip: this.post.ipAddress(),\n                                })}\n                            </label>\n                        </div>\n                    ))}\n                </div>\n\n                <div className=\"Form-group\">\n                    <label className=\"label\">Reason</label>\n                    <input type=\"text\" className=\"FormControl\" bidi={this.reason} />\n                </div>\n\n                {otherUsersBanned\n                    ? otherUsersBanned.length\n                        ? Alert.component({\n                              children: app.translator.trans('fof-ban-ips.lib.modal.ban_ip_users', { users: punctuateSeries(usernames) }),\n                              dismissible: false,\n                          })\n                        : Alert.component({\n                              children: app.translator.trans('fof-ban-ips.forum.modal.ban_ip_no_users'),\n                              dismissible: false,\n                              type: 'success',\n                          })\n                    : ''}\n\n                {otherUsersBanned && <br />}\n\n                <div className=\"Form-group\">\n                    <Button className=\"Button Button--primary\" type=\"submit\" loading={this.loading}>\n                        {usernames\n                            ? app.translator.trans('fof-ban-ips.lib.modal.submit_button')\n                            : app.translator.trans('fof-ban-ips.lib.modal.check_button')}\n                    </Button>\n                </div>\n            </div>\n        );\n    }\n\n    onsubmit(e) {\n        e.preventDefault();\n\n        this.loading = true;\n\n        if (typeof this.otherUsersBanned[this.banOption()] === 'undefined') return this.getOtherUsers();\n\n        const attrs = {\n            userId: this.user.id(),\n            reason: this.reason(),\n        };\n\n        if (this.banOption() === 'only') {\n            attrs.address = this.post.ipAddress();\n\n            app.store\n                .createRecord('banned_ips')\n                .save(attrs)\n                .then(this.hide.bind(this), this.onerror.bind(this), this.loaded.bind(this));\n        } else if (this.banOption() === 'all') {\n            app.request({\n                data: {\n                    data: {\n                        attributes: attrs,\n                    },\n                },\n                url: `${app.forum.attribute('apiUrl')}/fof/ban-ips/bans/chunk`,\n                method: 'POST',\n                errorHandler: this.onerror.bind(this),\n            })\n                .then(this.hide.bind(this))\n                .catch(() => {})\n                .then(this.loaded.bind(this));\n        }\n    }\n\n    getOtherUsers() {\n        const data = {};\n\n        if (this.banOption() === 'only') data.ip = this.post.ipAddress();\n\n        app.request({\n            data,\n            url: `${app.forum.attribute('apiUrl')}/fof/ban-ips/check-users/${this.user.id()}`,\n            method: 'GET',\n            errorHandler: this.onerror.bind(this),\n        })\n            .then(res => {\n                this.otherUsersBanned[this.banOption()] = res.data.map(e => app.store.pushObject(e));\n                this.loading = false;\n\n                m.lazyRedraw();\n            })\n            .catch(() => {})\n            .then(this.loaded.bind(this));\n    }\n}\n","import Model from 'flarum/Model';\nimport Forum from 'flarum/models/Forum';\n\nimport addBanIPControl from './addBanIPControl';\nimport BannedIP from '../common/models/BannedIP';\n\napp.initializers.add('fof/ban-ips', () => {\n    app.store.models.posts.prototype.canBanIP = Model.attribute('canBanIP');\n    app.store.models.posts.prototype.ipAddress = Model.attribute('ipAddress');\n    app.store.models.users.prototype.isBanned = Model.attribute('isBanned');\n\n    app.store.models.banned_ips = BannedIP;\n\n    Forum.prototype.bannedIPs = Model.hasMany('banned_ips');\n\n    addBanIPControl();\n});\n","module.exports = flarum.core.compat['Model'];","module.exports = flarum.core.compat['components/Alert'];","module.exports = flarum.core.compat['components/Button'];","module.exports = flarum.core.compat['components/Modal'];","module.exports = flarum.core.compat['extend'];","module.exports = flarum.core.compat['helpers/punctuateSeries'];","module.exports = flarum.core.compat['helpers/username'];","module.exports = flarum.core.compat['models/Forum'];","module.exports = flarum.core.compat['utils/PostControls'];","module.exports = flarum.core.compat['utils/mixin'];"],"sourceRoot":""}