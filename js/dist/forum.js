module.exports=function(t){var n={};function e(o){if(n[o])return n[o].exports;var a=n[o]={i:o,l:!1,exports:{}};return t[o].call(a.exports,a,a.exports,e),a.l=!0,a.exports}return e.m=t,e.c=n,e.d=function(t,n,o){e.o(t,n)||Object.defineProperty(t,n,{enumerable:!0,get:o})},e.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},e.t=function(t,n){if(1&n&&(t=e(t)),8&n)return t;if(4&n&&"object"==typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(e.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&n&&"string"!=typeof t)for(var a in t)e.d(o,a,function(n){return t[n]}.bind(null,a));return o},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,n){return Object.prototype.hasOwnProperty.call(t,n)},e.p="",e(e.s=19)}([function(t,n){t.exports=flarum.core.compat.Model},function(t,n,e){"use strict";function o(t,n){t.prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n}e.d(n,"a",function(){return o})},function(t,n){t.exports=flarum.core.compat.extend},function(t,n){t.exports=flarum.core.compat["components/Button"]},function(t,n){t.exports=flarum.core.compat["helpers/username"]},function(t,n){t.exports=flarum.core.compat["components/Alert"]},function(t,n){t.exports=flarum.core.compat["models/Forum"]},function(t,n){t.exports=flarum.core.compat["components/Modal"]},function(t,n){t.exports=flarum.core.compat["helpers/punctuateSeries"]},function(t,n,e){"use strict";e.d(n,"a",function(){return i});var o=e(1),a=e(0),r=e.n(a),s=e(10),i=function(t){function n(){return t.apply(this,arguments)||this}return Object(o.a)(n,t),n.prototype.apiEndpoint=function(){return"/fof/ban-ips/bans"+(this.exists?"/"+this.id():"")},n}(e.n(s)()(r.a,{creator:r.a.hasOne("creator"),user:r.a.hasOne("user"),address:r.a.attribute("address"),reason:r.a.attribute("reason"),createdAt:r.a.attribute("createdAt",r.a.transformDate),deletedAt:r.a.attribute("deletedAt",r.a.transformDate)}))},function(t,n){t.exports=flarum.core.compat["utils/mixin"]},function(t,n){t.exports=flarum.core.compat["utils/PostControls"]},function(t,n){t.exports=flarum.core.compat["models/User"]},function(t,n){t.exports=flarum.core.compat["components/Badge"]},,,,,,function(t,n,e){"use strict";e.r(n);var o=e(0),a=e.n(o),r=e(6),s=e.n(r),i=e(2),p=e(11),u=e.n(p),c=e(3),l=e.n(c),d=e(1),f=e(7),b=e.n(f),h=e(5),y=e.n(h),_=e(8),O=e.n(_),v=(e(4),function(t){function n(){return t.apply(this,arguments)||this}Object(d.a)(n,t);var e=n.prototype;return e.init=function(){this.post=this.props.post,this.user=this.post.user(),this.banOptions=["only","all"],this.banOption=m.prop(this.banOptions[0]),this.reason=m.prop(""),this.otherUsersBanned={},this.loading=!1},e.className=function(){return"Modal--medium"},e.title=function(){return app.translator.trans("fof-ban-ips.lib.modal.title")},e.content=function(){var t=this,n=this.otherUsersBanned[this.banOption()],e=n&&n.map(function(t){return t&&t.displayName()||app.translator.trans("core.lib.username.deleted_text")});return m("div",{className:"Modal-body"},m("p",null,app.translator.trans("fof-ban-ips.lib.modal.ban_ip_confirmation")),m("div",{className:"Form-group"},this.banOptions.map(function(n){return m("div",null,m("input",{type:"radio",name:"ban-option",id:"ban-option-"+n,checked:t.banOption()===n,onclick:t.banOption.bind(t,n)}),"Â ",m("label",{htmlFor:"ban-option-"+n},app.translator.trans("fof-ban-ips.forum.modal.ban_options_"+n+"_ip",{user:t.user,ip:t.post.ipAddress()})))})),m("div",{className:"Form-group"},m("label",{className:"label"},"Reason"),m("input",{type:"text",className:"FormControl",bidi:this.reason})),n?n.length?y.a.component({children:app.translator.trans("fof-ban-ips.lib.modal.ban_ip_users",{users:O()(e)}),dismissible:!1}):y.a.component({children:app.translator.trans("fof-ban-ips.forum.modal.ban_ip_no_users"),dismissible:!1,type:"success"}):"",n&&m("br",null),m("div",{className:"Form-group"},m(l.a,{className:"Button Button--primary",type:"submit",loading:this.loading},e?app.translator.trans("fof-ban-ips.lib.modal.submit_button"):app.translator.trans("fof-ban-ips.lib.modal.check_button"))))},e.onsubmit=function(t){if(t.preventDefault(),this.loading=!0,void 0===this.otherUsersBanned[this.banOption()])return this.getOtherUsers();var n={reason:this.reason()};"only"===this.banOption()?(n.address=this.post.ipAddress(),app.store.createRecord("banned_ips").save(n).then(this.hide.bind(this),this.onerror.bind(this),this.loaded.bind(this))):"all"===this.banOption()&&app.request({data:{data:{attributes:n}},url:""+app.forum.attribute("apiUrl")+this.user.apiEndpoint()+"/ban",method:"POST",errorHandler:this.onerror.bind(this)}).then(this.hide.bind(this)).catch(function(){}).then(this.loaded.bind(this))},e.getOtherUsers=function(){var t=this,n={};"only"===this.banOption()&&(n.ip=this.post.ipAddress()),app.request({data:n,url:app.forum.attribute("apiUrl")+"/fof/ban-ips/check-users/"+this.user.id(),method:"GET",errorHandler:this.onerror.bind(this)}).then(function(n){t.otherUsersBanned[t.banOption()]=n.data.map(function(t){return app.store.pushObject(t)}),t.loading=!1,m.lazyRedraw()}).catch(function(){}).then(this.loaded.bind(this))},n}(b.a)),x=e(9),g=e(12),B=e.n(g),j=e(13),P=e.n(j);app.initializers.add("fof/ban-ips",function(){app.store.models.posts.prototype.canBanIP=a.a.attribute("canBanIP"),app.store.models.posts.prototype.ipAddress=a.a.attribute("ipAddress"),app.store.models.users.prototype.isBanned=a.a.attribute("isBanned"),app.store.models.banned_ips=x.a,s.a.prototype.bannedIPs=a.a.hasMany("banned_ips"),Object(i.extend)(u.a,"userControls",function(t,n){var e=n.user().isBanned();n.canBanIP()&&!n.isHidden()&&n.user()!==app.session.user&&"comment"===n.contentType()&&t.add("banip",l.a.component({children:app.translator.trans(e?"fof-ban-ips.forum.already_banned_ip_button":"fof-ban-ips.forum.ban_ip_button"),className:"Button Button--link",icon:"fas fa-gavel",disabled:e,onclick:function(){return app.modal.show(new v({post:n}))}}))}),Object(i.extend)(B.a.prototype,"badges",function(t){this.isBanned()&&t.add("banned",P.a.component({icon:"fas fa-gavel",type:"banned",label:app.translator.trans("fof-ban-ips.forum.user_badge.banned_tooltip")}))})})}]);
//# sourceMappingURL=forum.js.map