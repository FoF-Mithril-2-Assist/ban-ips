{"version":3,"sources":["webpack://@fof/ban-ips/webpack/bootstrap","webpack://@fof/ban-ips/./admin.js","webpack://@fof/ban-ips/./node_modules/@babel/runtime/helpers/esm/inheritsLoose.js","webpack://@fof/ban-ips/./src/admin/addPermissions.js","webpack://@fof/ban-ips/./src/admin/addSettingsPage.js","webpack://@fof/ban-ips/./src/admin/components/BanIPModal.js","webpack://@fof/ban-ips/./src/admin/components/SettingsPage.js","webpack://@fof/ban-ips/./src/admin/index.js","webpack://@fof/ban-ips/./src/common/models/BannedIP.js","webpack://@fof/ban-ips/external \"flarum.core.compat['Model']\"","webpack://@fof/ban-ips/external \"flarum.core.compat['components/AdminLinkButton']\"","webpack://@fof/ban-ips/external \"flarum.core.compat['components/AdminNav']\"","webpack://@fof/ban-ips/external \"flarum.core.compat['components/Alert']\"","webpack://@fof/ban-ips/external \"flarum.core.compat['components/Button']\"","webpack://@fof/ban-ips/external \"flarum.core.compat['components/Modal']\"","webpack://@fof/ban-ips/external \"flarum.core.compat['components/Page']\"","webpack://@fof/ban-ips/external \"flarum.core.compat['components/PermissionGrid']\"","webpack://@fof/ban-ips/external \"flarum.core.compat['extend']\"","webpack://@fof/ban-ips/external \"flarum.core.compat['helpers/punctuateSeries']\"","webpack://@fof/ban-ips/external \"flarum.core.compat['helpers/username']\"","webpack://@fof/ban-ips/external \"flarum.core.compat['models/Forum']\"","webpack://@fof/ban-ips/external \"flarum.core.compat['utils/mixin']\""],"names":["extend","PermissionGrid","prototype","items","add","icon","label","app","translator","trans","permission","routes","path","component","SettingsPage","extensionSettings","m","route","AdminNav","AdminLinkButton","href","children","description","BanIPModal","init","address","prop","reason","usersBanned","loading","className","title","content","usernames","map","username","length","Alert","users","punctuateSeries","dismissible","type","store","getBy","onsubmit","e","preventDefault","getOtherUsers","attrs","createRecord","save","then","hide","bind","onerror","loaded","data","ip","request","url","forum","attribute","method","errorHandler","res","pushObject","lazyRedraw","Modal","bannedIPs","all","page","pageSize","pageNumber","Math","ceil","view","Button","onclick","modal","show","width","textAlign","slice","b","id","creator","user","createdAt","toLocaleDateString","Page","initializers","models","banned_ips","BannedIP","Forum","Model","hasMany","addPermissions","addSettingsPage","apiEndpoint","exists","mixin","hasOne","transformDate","deletedAt"],"mappings":"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","file":"admin.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./admin.js\");\n","export * from './src/admin';\n","export default function _inheritsLoose(subClass, superClass) {\n  subClass.prototype = Object.create(superClass.prototype);\n  subClass.prototype.constructor = subClass;\n  subClass.__proto__ = superClass;\n}","import { extend } from 'flarum/extend';\nimport PermissionGrid from 'flarum/components/PermissionGrid';\n\nexport default () => {\n    extend(PermissionGrid.prototype, 'moderateItems', items => {\n        items.add('viewBannedIPList', {\n            icon: 'fas fa-gavel',\n            label: app.translator.trans('fof-ban-ips.admin.permissions.view_banned_ip_list_label'),\n            permission: 'fof.ban-ips.viewBannedIPList',\n        });\n\n        items.add('banIP', {\n            icon: 'fas fa-gavel',\n            label: app.translator.trans('fof-ban-ips.admin.permissions.ban_ip_label'),\n            permission: 'fof.ban-ips.banIP',\n        });\n    });\n};\n","import { extend } from 'flarum/extend';\nimport AdminNav from 'flarum/components/AdminNav';\nimport AdminLinkButton from 'flarum/components/AdminLinkButton';\n\nimport SettingsPage from './components/SettingsPage';\n\nexport default () => {\n    app.routes['fof-ban-ips'] = { path: '/fof/ban-ips', component: SettingsPage.component() };\n\n    app.extensionSettings['fof-ban-ips'] = () => m.route(app.route('fof-ban-ips'));\n\n    extend(AdminNav.prototype, 'items', items => {\n        items.add(\n            'fof-ban-ips',\n            AdminLinkButton.component({\n                href: app.route('fof-ban-ips'),\n                icon: 'fas fa-gavel',\n                children: app.translator.trans('fof-ban-ips.admin.nav.title'),\n                description: app.translator.trans('fof-ban-ips.admin.nav.desc'),\n            })\n        );\n    });\n};\n","import Modal from 'flarum/components/Modal';\nimport Button from 'flarum/components/Button';\nimport Alert from 'flarum/components/Alert';\nimport punctuateSeries from 'flarum/helpers/punctuateSeries';\nimport username from 'flarum/helpers/username';\n\nexport default class BanIPModal extends Modal {\n    init() {\n        this.address = m.prop('');\n        this.reason = m.prop('');\n\n        this.usersBanned = {};\n\n        this.loading = false;\n    }\n\n    className() {\n        return 'Modal--medium';\n    }\n\n    title() {\n        return app.translator.trans('fof-ban-ips.lib.modal.title');\n    }\n\n    content() {\n        const usersBanned = this.usersBanned[this.address()];\n        const usernames = usersBanned && usersBanned.map(username);\n\n        return (\n            <div className=\"Modal-body\">\n                <p>{app.translator.trans('fof-ban-ips.lib.modal.ban_ip_confirmation')}</p>\n\n                <div className=\"Form-group\">\n                    <label className=\"label\">IP Address</label>\n                    <input type=\"text\" className=\"FormControl\" bidi={this.address} required pattern=\"^([0-9]{1,3}\\.){3}[0-9]{1,3}$\" />\n                </div>\n\n                <div className=\"Form-group\">\n                    <label className=\"label\">Reason</label>\n                    <input type=\"text\" className=\"FormControl\" bidi={this.reason} />\n                </div>\n\n                {usersBanned\n                    ? usersBanned.length\n                        ? Alert.component({\n                              children: app.translator.trans('fof-ban-ips.lib.modal.ban_ip_users', { users: punctuateSeries(usernames) }),\n                              dismissible: false,\n                          })\n                        : Alert.component({\n                              children: app.translator.trans('fof-ban-ips.admin.modal.ban_ip_no_users'),\n                              dismissible: false,\n                              type: 'success',\n                          })\n                    : ''}\n\n                {usersBanned && <br />}\n\n                <div className=\"Form-group\">\n                    <Button\n                        className=\"Button Button--primary\"\n                        type=\"submit\"\n                        loading={this.loading}\n                        disabled={app.store.getBy('banned_ips', 'address', this.address())}\n                    >\n                        {usernames\n                            ? app.translator.trans('fof-ban-ips.lib.modal.submit_button')\n                            : app.translator.trans('fof-ban-ips.lib.modal.check_button')}\n                    </Button>\n                </div>\n            </div>\n        );\n    }\n\n    onsubmit(e) {\n        e.preventDefault();\n\n        if (!this.address()) return;\n\n        this.loading = true;\n\n        if (typeof this.usersBanned[this.address()] === 'undefined') return this.getOtherUsers();\n\n        const attrs = {\n            address: this.address(),\n            reason: this.reason(),\n        };\n\n        app.store\n            .createRecord('banned_ips')\n            .save(attrs)\n            .then(this.hide.bind(this), this.onerror.bind(this), this.loaded.bind(this));\n    }\n\n    getOtherUsers() {\n        const data = {\n            ip: this.address(),\n        };\n\n        app.request({\n            data,\n            url: `${app.forum.attribute('apiUrl')}/fof/ban-ips/check-users`,\n            method: 'GET',\n            errorHandler: this.onerror.bind(this),\n        })\n            .then(res => {\n                this.usersBanned[this.address()] = res.data.map(e => app.store.pushObject(e));\n                this.loading = false;\n\n                m.lazyRedraw();\n            })\n            .catch(() => {})\n            .then(this.loaded.bind(this));\n    }\n}\n","import Button from 'flarum/components/Button';\nimport Page from 'flarum/components/Page';\n\nimport username from 'flarum/helpers/username';\nimport BanIPModal from './BanIPModal';\n\nexport default class SettingsPage extends Page {\n    init() {\n        const bannedIPs = app.store.all('banned_ips');\n\n        this.page = 0;\n        this.pageSize = 20;\n        this.pageNumber = Math.ceil(bannedIPs.length / this.pageSize);\n    }\n\n    view() {\n        return (\n            <div className=\"BannedIPsPage\">\n                <div className=\"BannedIPsPage-header\">\n                    <div className=\"container\">\n                        <p>{app.translator.trans('fof-ban-ips.admin.page.about_text')}</p>\n                        {Button.component({\n                            className: 'Button Button--primary',\n                            icon: 'fas fa-plus',\n                            children: app.translator.trans('fof-ban-ips.admin.page.create_button'),\n                            onclick: () => app.modal.show(new BanIPModal()),\n                        })}\n                    </div>\n                </div>\n                <br />\n                <div className=\"BannedIpsPage-table\">\n                    <div className=\"container\">\n                        <table style={{ width: '100%', textAlign: 'left' }} class=\"table\">\n                            <thead>\n                                <tr>\n                                    <th>#</th>\n                                    <th>Creator</th>\n                                    <th>User</th>\n                                    <th>Address</th>\n                                    <th>Reason</th>\n                                    <th>Date</th>\n                                </tr>\n                            </thead>\n                            <tbody>\n                                {app.store\n                                    .all('banned_ips')\n                                    .slice(this.page, this.page + this.pageSize)\n                                    .map(b => (\n                                        <tr>\n                                            <td>{b.id()}</td>\n                                            <td>{username(b.creator())}</td>\n                                            <td>{username(b.user())}</td>\n                                            <td>{b.address()}</td>\n                                            <td>{b.reason()}</td>\n                                            <td>{b.createdAt().toLocaleDateString()}</td>\n                                        </tr>\n                                    ))}\n                            </tbody>\n                        </table>\n                    </div>\n                </div>\n            </div>\n        );\n    }\n}\n","import Model from 'flarum/Model';\nimport Forum from 'flarum/models/Forum';\n\nimport BannedIP from '../common/models/BannedIP';\nimport addPermissions from './addPermissions';\nimport addSettingsPage from './addSettingsPage';\n\napp.initializers.add('fof/ban-ips', () => {\n    app.store.models.banned_ips = BannedIP;\n\n    Forum.prototype.bannedIPs = Model.hasMany('banned_ips');\n\n    addPermissions();\n    addSettingsPage();\n});\n","import Model from 'flarum/Model';\nimport mixin from 'flarum/utils/mixin';\n\nexport default class BannedIP extends mixin(Model, {\n    creator: Model.hasOne('creator'),\n    user: Model.hasOne('user'),\n    address: Model.attribute('address'),\n    reason: Model.attribute('reason'),\n    createdAt: Model.attribute('createdAt', Model.transformDate),\n    deletedAt: Model.attribute('deletedAt', Model.transformDate),\n}) {\n    apiEndpoint() {\n        return `/fof/ban-ips${this.exists ? `/${this.id()}` : ''}`;\n    }\n}\n","module.exports = flarum.core.compat['Model'];","module.exports = flarum.core.compat['components/AdminLinkButton'];","module.exports = flarum.core.compat['components/AdminNav'];","module.exports = flarum.core.compat['components/Alert'];","module.exports = flarum.core.compat['components/Button'];","module.exports = flarum.core.compat['components/Modal'];","module.exports = flarum.core.compat['components/Page'];","module.exports = flarum.core.compat['components/PermissionGrid'];","module.exports = flarum.core.compat['extend'];","module.exports = flarum.core.compat['helpers/punctuateSeries'];","module.exports = flarum.core.compat['helpers/username'];","module.exports = flarum.core.compat['models/Forum'];","module.exports = flarum.core.compat['utils/mixin'];"],"sourceRoot":""}