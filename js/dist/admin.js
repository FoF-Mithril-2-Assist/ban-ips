module.exports=function(t){var n={};function e(a){if(n[a])return n[a].exports;var r=n[a]={i:a,l:!1,exports:{}};return t[a].call(r.exports,r,r.exports,e),r.l=!0,r.exports}return e.m=t,e.c=n,e.d=function(t,n,a){e.o(t,n)||Object.defineProperty(t,n,{enumerable:!0,get:a})},e.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},e.t=function(t,n){if(1&n&&(t=e(t)),8&n)return t;if(4&n&&"object"==typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(e.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&n&&"string"!=typeof t)for(var r in t)e.d(a,r,function(n){return t[n]}.bind(null,r));return a},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,n){return Object.prototype.hasOwnProperty.call(t,n)},e.p="",e(e.s=18)}([function(t,n){t.exports=flarum.core.compat.Model},function(t,n,e){"use strict";function a(t,n){t.prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n}e.d(n,"a",function(){return a})},function(t,n){t.exports=flarum.core.compat.extend},function(t,n){t.exports=flarum.core.compat["components/Button"]},function(t,n){t.exports=flarum.core.compat["helpers/username"]},function(t,n){t.exports=flarum.core.compat["components/Alert"]},function(t,n){t.exports=flarum.core.compat["models/Forum"]},function(t,n){t.exports=flarum.core.compat["components/Modal"]},function(t,n){t.exports=flarum.core.compat["helpers/punctuateSeries"]},function(t,n,e){"use strict";e.d(n,"a",function(){return i});var a=e(1),r=e(0),o=e.n(r),s=e(10),i=function(t){function n(){return t.apply(this,arguments)||this}return Object(a.a)(n,t),n.prototype.apiEndpoint=function(){return"/fof/ban-ips"+(this.exists?"/"+this.id():"")},n}(e.n(s)()(o.a,{creator:o.a.hasOne("creator"),user:o.a.hasOne("user"),address:o.a.attribute("address"),reason:o.a.attribute("reason"),createdAt:o.a.attribute("createdAt",o.a.transformDate),deletedAt:o.a.attribute("deletedAt",o.a.transformDate)}))},function(t,n){t.exports=flarum.core.compat["utils/mixin"]},,,,function(t,n){t.exports=flarum.core.compat["components/PermissionGrid"]},function(t,n){t.exports=flarum.core.compat["components/AdminNav"]},function(t,n){t.exports=flarum.core.compat["components/AdminLinkButton"]},function(t,n){t.exports=flarum.core.compat["components/Page"]},function(t,n,e){"use strict";e.r(n);var a=e(0),r=e.n(a),o=e(6),s=e.n(o),i=e(9),p=e(2),l=e(14),u=e.n(l),c=e(15),d=e.n(c),f=e(16),b=e.n(f),h=e(1),g=e(3),v=e.n(g),y=e(17),_=e.n(y),x=e(4),N=e.n(x),O=e(7),P=e.n(O),B=e(5),j=e.n(B),A=e(8),S=e.n(A),I=function(t){function n(){return t.apply(this,arguments)||this}Object(h.a)(n,t);var e=n.prototype;return e.init=function(){this.address=m.prop(""),this.reason=m.prop(""),this.usersBanned={},this.loading=!1},e.className=function(){return"Modal--medium"},e.title=function(){return app.translator.trans("fof-ban-ips.lib.modal.title")},e.content=function(){var t=this.usersBanned[this.address()],n=t&&t.map(N.a);return m("div",{className:"Modal-body"},m("p",null,app.translator.trans("fof-ban-ips.lib.modal.ban_ip_confirmation")),m("div",{className:"Form-group"},m("label",{className:"label"},"IP Address"),m("input",{type:"text",className:"FormControl",bidi:this.address,required:!0,pattern:"^([0-9]{1,3}\\.){3}[0-9]{1,3}$"})),m("div",{className:"Form-group"},m("label",{className:"label"},"Reason"),m("input",{type:"text",className:"FormControl",bidi:this.reason})),t?t.length?j.a.component({children:app.translator.trans("fof-ban-ips.lib.modal.ban_ip_users",{users:S()(n)}),dismissible:!1}):j.a.component({children:app.translator.trans("fof-ban-ips.admin.modal.ban_ip_no_users"),dismissible:!1,type:"success"}):"",t&&m("br",null),m("div",{className:"Form-group"},m(v.a,{className:"Button Button--primary",type:"submit",loading:this.loading,disabled:app.store.getBy("banned_ips","address",this.address())},n?app.translator.trans("fof-ban-ips.lib.modal.submit_button"):app.translator.trans("fof-ban-ips.lib.modal.check_button"))))},e.onsubmit=function(t){if(t.preventDefault(),this.address()){if(this.loading=!0,void 0===this.usersBanned[this.address()])return this.getOtherUsers();var n={address:this.address(),reason:this.reason()};app.store.createRecord("banned_ips").save(n).then(this.hide.bind(this),this.onerror.bind(this),this.loaded.bind(this))}},e.getOtherUsers=function(){var t=this,n={ip:this.address()};app.request({data:n,url:app.forum.attribute("apiUrl")+"/fof/ban-ips/check-users",method:"GET",errorHandler:this.onerror.bind(this)}).then(function(n){t.usersBanned[t.address()]=n.data.map(function(t){return app.store.pushObject(t)}),t.loading=!1,m.lazyRedraw()}).catch(function(){}).then(this.loaded.bind(this))},n}(P.a),M=function(t){function n(){return t.apply(this,arguments)||this}Object(h.a)(n,t);var e=n.prototype;return e.init=function(){var t=app.store.all("banned_ips");this.page=0,this.pageSize=20,this.pageNumber=Math.ceil(t.length/this.pageSize)},e.view=function(){return m("div",{className:"BannedIPsPage"},m("div",{className:"BannedIPsPage-header"},m("div",{className:"container"},m("p",null,app.translator.trans("fof-ban-ips.admin.page.about_text")),v.a.component({className:"Button Button--primary",icon:"fas fa-plus",children:app.translator.trans("fof-ban-ips.admin.page.create_button"),onclick:function(){return app.modal.show(new I)}}))),m("br",null),m("div",{className:"BannedIpsPage-table"},m("div",{className:"container"},m("table",{style:{width:"100%",textAlign:"left"},class:"table"},m("thead",null,m("tr",null,m("th",null,"#"),m("th",null,"Creator"),m("th",null,"User"),m("th",null,"Address"),m("th",null,"Reason"),m("th",null,"Date"))),m("tbody",null,app.store.all("banned_ips").slice(this.page,this.page+this.pageSize).map(function(t){return m("tr",null,m("td",null,t.id()),m("td",null,N()(t.creator())),m("td",null,N()(t.user())),m("td",null,t.address()),m("td",null,t.reason()),m("td",null,t.createdAt().toLocaleDateString()))}))))))},n}(_.a);app.initializers.add("fof/ban-ips",function(){app.store.models.banned_ips=i.a,s.a.prototype.bannedIPs=r.a.hasMany("banned_ips"),Object(p.extend)(u.a.prototype,"moderateItems",function(t){t.add("viewBannedIPList",{icon:"fas fa-gavel",label:app.translator.trans("fof-ban-ips.admin.permissions.view_banned_ip_list_label"),permission:"fof.ban-ips.viewBannedIPList"}),t.add("banIP",{icon:"fas fa-gavel",label:app.translator.trans("fof-ban-ips.admin.permissions.ban_ip_label"),permission:"fof.ban-ips.banIP"})}),app.routes["fof-ban-ips"]={path:"/fof/ban-ips",component:M.component()},app.extensionSettings["fof-ban-ips"]=function(){return m.route(app.route("fof-ban-ips"))},Object(p.extend)(d.a.prototype,"items",function(t){t.add("fof-ban-ips",b.a.component({href:app.route("fof-ban-ips"),icon:"fas fa-gavel",children:app.translator.trans("fof-ban-ips.admin.nav.title"),description:app.translator.trans("fof-ban-ips.admin.nav.desc")}))})})}]);
//# sourceMappingURL=admin.js.map